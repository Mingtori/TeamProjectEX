/* members */
DROP TABLE members 
	CASCADE CONSTRAINTS;

/* memgrade */
DROP TABLE memgrade 
	CASCADE CONSTRAINTS;

/* products */
DROP TABLE products 
	CASCADE CONSTRAINTS;

/* productscategory */
DROP TABLE prodcategory 
	CASCADE CONSTRAINTS;

/* sellproductslist */
DROP TABLE selllist 
	CASCADE CONSTRAINTS;

/* boards */
DROP TABLE boards 
	CASCADE CONSTRAINTS;

/* boardscategory */
DROP TABLE boardscategory 
	CASCADE CONSTRAINTS;

/* orders */
DROP TABLE orders 
	CASCADE CONSTRAINTS;

/* company */
DROP TABLE company 
	CASCADE CONSTRAINTS;

/* cart */
DROP TABLE cart 
	CASCADE CONSTRAINTS;

drop sequence boardseq;
  
create sequence boardseq
  increment by 1
  start with 0
  minvalue 0
  maxvalue 10000
  nocache;
  
drop sequence productseq;
  
create sequence productseq
  increment by 1
  start with 0
  minvalue 0
  maxvalue 10000
  nocache;
  
drop sequence companyseq;
  
create sequence companyseq
  increment by 1
  start with 0
  minvalue 0
  maxvalue 10000
  nocache;

drop sequence boardseq;
  
create sequence boardseq
  increment by 1
  start with 0
  minvalue 0
  maxvalue 10000
  nocache;


/* members */
CREATE TABLE members (
	memid VARCHAR2(15) NOT NULL, /* 회원ID */
	mempw VARCHAR2(10) NOT NULL, /* 비밀번호 */
	memname VARCHAR2(10) NOT NULL, /* 이름 */
	memaddr VARCHAR2(40), /* 주소 */
	memphone VARCHAR2(13), /* 전화번호 */
	mememail VARCHAR2(20) NOT NULL, /* 이메일 */
	mempermit VARCHAR2(10) DEFAULT '승인', /* 가입승인 */
	gradeid NUMBER default 1 NOT NULL, /* 회원등급ID */
	comid NUMBER /* 회사ID */
);



ALTER TABLE members
	ADD
		CONSTRAINT PKmembers
		PRIMARY KEY (
			memid
		);

/* memgrade */
CREATE TABLE memgrade (
	gradeid NUMBER NOT NULL, /* 회원등급ID */
	gradename VARCHAR2(10) NOT NULL /* 등급이름 */
);



ALTER TABLE memgrade
	ADD
		CONSTRAINT PKmemgrade
		PRIMARY KEY (
			gradeid
		);

/* products */
CREATE TABLE products (
	prodid NUMBER NOT NULL, /* 상품ID */
	prodname VARCHAR2(50) NOT NULL, /* 상품명 */
	prodcateid NUMBER NOT NULL, /* 카테고리ID */
	prodimage VARCHAR2(50) NOT NULL, /* 이미지 */
	prodprice NUMBER NOT NULL, /* 가격 */
	prodstock NUMBER NOT NULL, /* 재고수량 */
	prodinputdate DATE DEFAULT SYSDATE, /* 등록일자 */
	prodstartdate DATE NOT NULL, /* 시작일자 */
	prodenddate DATE NOT NULL, /* 종료일자 */
	prodcontent VARCHAR2(1000) NOT NULL /* 내용 */,
	prodplace VARCHAR2(50) NOT NULL /* 장소 */
);



ALTER TABLE products
	ADD
		CONSTRAINT PKproducts
		PRIMARY KEY (
			prodid
		);

/* productscategory */
CREATE TABLE prodcategory (
	prodcateid NUMBER NOT NULL, /* 카테고리ID */
	prodcatename VARCHAR(10) NOT NULL /* 카테고리명 */
);


ALTER TABLE prodcategory
	ADD
		CONSTRAINT PKprodcategory
		PRIMARY KEY (
			prodcateid
		);

/* selllist */
CREATE TABLE selllist (
	memid VARCHAR2(15) NOT NULL, /* 회원ID */
	prodid NUMBER NOT NULL /* 상품ID */
);

ALTER TABLE selllist
	ADD
		CONSTRAINT PKselllist
		PRIMARY KEY (
			memid,
			prodid
		);

/* boards */
CREATE TABLE boards (
	boardid NUMBER NOT NULL, /* 게시글ID */
	boardsubject VARCHAR2(50) NOT NULL, /* 제목 */
	memid VARCHAR2(15) NOT NULL, /* 회원ID */
	boardcateid VARCHAR2(5) NOT NULL, /* 카테고리ID */
	prodid NUMBER, /* 상품ID */
	boardcontent VARCHAR2(500) NOT NULL, /* 내용 */
	ref NUMBER DEFAULT 0, /* ref */
	restep NUMBER DEFAULT 0, /* restep */
	relevel NUMBER DEFAULT 0, /* relevel */
	boardip VARCHAR2(15) NOT NULL, /* IP */
	boardimage VARCHAR2(50), /* 이미지 */
	boardinputdate DATE DEFAULT SYSDATE, /* 게시일자 */
	boardreadcount NUMBER DEFAULT 0 /* 조회수 */
);

ALTER TABLE boards
	ADD
		CONSTRAINT PKboards
		PRIMARY KEY (
			boardid
		);

/* boardscategory */
CREATE TABLE boardscategory (
	boardcateid VARCHAR2(5) NOT NULL, /* 카테고리ID */
	boardcatename VARCHAR2(15) NOT NULL /* 카테고리명 */
);


ALTER TABLE boardscategory
	ADD
		CONSTRAINT PKboardscategory
		PRIMARY KEY (
			boardcateid
		);

/* orders */
CREATE TABLE orders (
	orderid VARCHAR2(30) NOT NULL, /* 주문ID */
	orderqty NUMBER NOT NULL, /* 수량 */
	orderuse VARCHAR2(5) DEFAULT 'NO', /* 사용여부 */
	prodid NUMBER
);

ALTER TABLE orders
	ADD
		CONSTRAINT PKorders
		PRIMARY KEY (
			orderid
		);

ALTER TABLE orders
	ADD
		CONSTRAINT FKproductsTOorders
		FOREIGN KEY (
			prodid
		)
		REFERENCES products (
			prodid
		);
/* company */
CREATE TABLE company (
	comid NUMBER NOT NULL, /* 회사ID */
	comname VARCHAR2(25) NOT NULL UNIQUE, /* 회사이름 */
	comaddr VARCHAR2(50) NOT NULL /* 회사주소 */
);

ALTER TABLE company
	ADD
		CONSTRAINT PKcompany
		PRIMARY KEY (
			comid
		);

/* cart */
CREATE TABLE cart (
	cartid VARCHAR2(30) NOT NULL, /* 장바구니ID */
	cartqty NUMBER NOT NULL /* 수량 */
);

ALTER TABLE cart
	ADD
		CONSTRAINT PKcart
		PRIMARY KEY (
			cartid
		);

ALTER TABLE members
	ADD
		CONSTRAINT FKmemgradeTOmembers
		FOREIGN KEY (
			gradeid
		)
		REFERENCES memgrade (
			gradeid
		);

ALTER TABLE members
	ADD
		CONSTRAINT FKcompanyTOmembers
		FOREIGN KEY (
			comid
		)
		REFERENCES company (
			comid
		) ON DELETE SET NULL;

ALTER TABLE products
	ADD
		CONSTRAINT FKprodcategoryTOproducts
		FOREIGN KEY (
			prodcateid
		)
		REFERENCES prodcategory (
			prodcateid
		);

ALTER TABLE selllist
	ADD
		CONSTRAINT FKmembersTOselllist
		FOREIGN KEY (
			memid 
		)
		REFERENCES members (
			memid
		) ON DELETE CASCADE;

ALTER TABLE selllist
	ADD
		CONSTRAINT FKproductsTOselllist
		FOREIGN KEY (
			prodid 
		) 
		REFERENCES products (
			prodid 
		) ON DELETE CASCADE;

ALTER TABLE boards
	ADD
		CONSTRAINT FKmembersTOboards
		FOREIGN KEY (
			memid
		)
		REFERENCES members (
			memid
		) ON DELETE CASCADE;

ALTER TABLE boards
	ADD
		CONSTRAINT FKboardscategoryTOboards
		FOREIGN KEY (
			boardcateid
		)
		REFERENCES boardscategory (
			boardcateid
		);

ALTER TABLE boards
	ADD
		CONSTRAINT FKproductsTOboards
		FOREIGN KEY (
			prodid
		)
		REFERENCES products (
			prodid
		) ON DELETE CASCADE;
		
		
		
		
INSERT INTO memgrade VALUES(0, '관리자');
INSERT INTO memgrade VALUES(1, '일반회원');
INSERT INTO memgrade VALUES(2, '판매자');
		
INSERT INTO prodcategory VALUES(0, '전시');
INSERT INTO prodcategory VALUES(1, '행사');


insert into products
values(0,'게시판용','0','0',0,0,sysdate,sysdate,sysdate,'0',' ');
		
		
insert into members(memid,mempw,memname,mememail,mempermit,gradeid)
values('admin','1234','관리자','admin@gmail.com','',0);		
insert into members
values('seller1', '1234', '판매자1', '서울특별시 마포구 신촌로 176','010-1111-1111','seller1@gmail.com','승인',2,1);
insert into members
values('seller2', '1234', '판매자2', '인천광역시 남구 인하로','010-2222-2222','seller2@gmail.com','승인',2,2);
insert into members
values('seller3', '1234', '판매자3', '경기도 고양시','010-3333-3333','seller3@gmail.com','승인',2,3);
insert into members
values('buyer1', '1234', '구매자1', '부산광역시 동구','010-4444-4444','buyer1@naver.com','승인',1,null);
insert into members
values('buyer2', '1234', '구매자2', '부산광역시 동구','010-5555-5555','buyer2@naver.com','승인',1,null);


insert into company
values(companyseq.nextval, '예술의전당', '서울특별시 서초구 서초동');
insert into company
values(companyseq.nextval, '코엑스', '서울특별시 강남구');
insert into company
values(companyseq.nextval, '킨텍스', '경기도 고양시 일산서구');


INSERT INTO boardscategory VALUES('a01', '전체공지사항');
INSERT INTO boardscategory VALUES('a02', '전체문의사항');
INSERT INTO boardscategory VALUES('p01', '상품공지사항');
INSERT INTO boardscategory VALUES('p02', '상품문의사항');
INSERT INTO boardscategory VALUES('p03', '상품후기');