<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 	 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="myboard">
	<select id="getTotalCount" parameterType="hashMap" resultType="int">
		select count(*) from boards
		<if test="boardcateid != null">
			where boardcateid = #{boardcateid}
		</if>
		<if test="whatColumn == 'boardsubject'">
			and boardsubject like #{keyword}
		</if>

		<if test="whatColumn == 'boardcontent'">
			and boardcontent like #{keyword}
		</if>
	</select>

	<select id="getBoardLists" parameterType="hashMap" resultType="MyBoard">
		select * from boards
		<where>
			<if test="boardcateid != null">
				boardcateid = #{boardcateid}
			</if>

			<if test="whatColumn == 'boardsubject'">
				and boardsubject like #{keyword}
			</if>

			<if test="whatColumn == 'boardcontent'">
				and boardcontent like #{keyword}
			</if>
		</where>
		order by boardid desc
	</select>
	
	<insert id="insertBoard" parameterType="MyBoard">
		insert into
		boards
		values (
		boardseq.nextval
		, #{boardsubject, jdbcType=VARCHAR}
		,
		#{memid,
		jdbcType=VARCHAR}
		, #{boardcateid, jdbcType=VARCHAR}
		, null
		,
		#{boardcontent}
		, #{ref}
		, #{restep}
		, #{relevel}
		, #{boardip,
		jdbcType=VARCHAR}
		, #{boardimage, jdbcType=VARCHAR}
		, sysdate
		,
		#{boardreadcount}
		)
	</insert>
	
	<select id="getArticle" resultType="MyBoard">
		select * from boards where
		boardid=#{boardid}
	</select>
	
	<update id="readCountUpdate">
		update boards set boardreadcount = boardreadcount+1
		where boardid=#{boardid}
	</update>
	
	<delete id="deleteArticle">
		delete from boards where boardid=#{boardid}
	</delete>
	
	<update id="updateArticle">
		update boards
		set boardsubject=#{boardsubject}, boardcontent=#{boardcontent}
		where boardid=#{boardid}
	</update>
</mapper>